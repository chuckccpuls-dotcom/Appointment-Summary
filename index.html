<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Appointment Summary</title>

<style>
  * {
    font-family: Helvetica, Arial, sans-serif;
    font-weight: 400;
  }

  body {
    max-width: 900px;
    margin: 30px auto;
    padding: 20px;
    color: #000;
  }

  h3 {
    margin-top: 25px;
    border-bottom: 2px solid #000;
    padding-bottom: 5px;
    font-weight: 600;
  }

  label {
    font-weight: 600;
    font-size: 13px;
    margin-bottom: 2px;
    display: block;
  }

  .header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
  }

  .logo {
    max-width: 160px;
  }

  .logo img {
    width: 100%;
  }

  .company {
    font-size: 13px;
    text-align: right;
  }

  .grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 6px 20px;
    margin-top: 15px;
  }

  input, textarea, select {
    width: 100%;
    padding: 5px;
    font-size: 13px;
    box-sizing: border-box;
  }

  textarea {
    height: 80px;
  }

  .full {
    grid-column: 1 / -1;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 12px;
  }

  th, td {
    border: 1px solid #000;
    padding: 8px;
    font-size: 13px;
  }

  .right {
    text-align: right;
  }

  .btn {
    margin-top: 10px;
    padding: 6px 12px;
    font-size: 12px;
    cursor: pointer;
  }

  .totals {
    width: 320px;
    margin-left: auto;
    margin-top: 15px;
  }
</style>
</head>

<body>

<div class="header">
  <div class="logo">
    <img src="puls-logo.png" alt="Puls Logo">
  </div>
  <div class="company">
    1 Sansome Street, Suite 3500, #10054, San Francisco, 94104<br>
    Support@Puls.com<br>
    (860) 596-0177
  </div>
</div>

<div class="grid">
  <div><label>Customer Name</label><input></div>
  <div><label>Appointment ID</label><input id="appointmentId"></div>
  <div><label>Email Address</label><input></div>
  <div><label>Date</label><input></div>
  <div><label>Phone Number</label><input></div>
  <div><label>Technician</label><input></div>
  <div class="full"><label>Address</label><input></div>
  <div>
    <label>Service Type</label>
    <select><option>Inspection</option></select>
  </div>
  <div>
    <label>Appliance Type</label>
    <select><option>Refrigerator</option></select>
  </div>
</div>

<h3>Appointment Summary</h3>
<label>Inspection Note:</label>
<textarea></textarea>

<label>Recommendation:</label>
<textarea></textarea>

<h3>Labor</h3>
<table id="laborTable">
  <tr><th>Description</th><th class="right">Amount</th></tr>
</table>

<h3>Parts</h3>
<table id="partsTable">
  <tr><th>Description</th><th class="right">Amount</th></tr>
</table>

<table class="totals">
  <tr><td>Total</td><td><input id="total"></td></tr>
</table>

<button class="btn" onclick="downloadPDF()">Download PDF</button>

<script>
function downloadPDF() {
  const title = "Appointment Summary";

  const clone = document.body.cloneNode(true);

  // remove buttons
  clone.querySelectorAll("button").forEach(b => b.remove());

  // flatten inputs, textareas, selects
  clone.querySelectorAll("input, textarea, select").forEach(el => {
    let text = "";
    if (el.tagName === "SELECT") {
      text = el.options[el.selectedIndex]?.text || "";
    } else {
      text = el.value || "";
    }

    const span = document.createElement("span");
    span.textContent = text;
    span.style.display = "block";
    span.style.fontSize = "13px";
    span.style.padding = "5px 0";

    el.replaceWith(span);
  });

  const printWindow = window.open("", "_blank", "width=900,height=650");
  printWindow.document.write(`
    <!DOCTYPE html>
    <html>
    <head>
      <title>${title}</title>
      <style>${document.querySelector("style").innerHTML}</style>
    </head>
    <body>${clone.innerHTML}
      <script>
        window.onload = function() {
          window.print();
          window.onafterprint = function(){ window.close(); }
        };
      <\/script>
    </body>
    </html>
  `);
  printWindow.document.close();
}
</script>

</body>
</html>
