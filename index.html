<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Appointment Summary</title>

<style>
  * {
    font-family: Helvetica, Arial, sans-serif;
    font-weight: 400;
  }

  body {
    max-width: 900px;
    margin: 30px auto;
    padding: 20px;
    color: #000;
  }

  h3 {
    margin-top: 25px;
    border-bottom: 2px solid #000;
    padding-bottom: 5px;
    font-weight: 600;
  }

  label {
    font-weight: 600;
    font-size: 13px;
    margin-bottom: 2px;
    display: block;
  }

  th {
    font-weight: 600;
  }

  .header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
  }

  .logo {
    max-width: 160px;
  }

  .logo img {
    width: 100%;
  }

  .company {
    font-size: 13px;
    text-align: right;
    line-height: 1.4;
  }

  .grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 6px 20px;
    margin-top: 15px;
  }

  input, textarea, select {
    width: 100%;
    padding: 5px;
    font-size: 13px;
    box-sizing: border-box;
  }

  textarea {
    height: 80px;
  }

  .full {
    grid-column: 1 / -1;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 12px;
  }

  th, td {
    border: 1px solid #000;
    padding: 8px;
    font-size: 13px;
  }

  .right {
    text-align: right;
  }

  .btn {
    margin-top: 10px;
    padding: 6px 12px;
    font-size: 12px;
    cursor: pointer;
  }

  .totals {
    width: 320px;
    margin-left: auto;
    margin-top: 15px;
  }
</style>
</head>

<body>

<!-- HEADER -->
<div class="header">
  <div class="logo">
    <img src="puls-logo.png" alt="Puls Logo">
  </div>
  <div class="company">
    1 Sansome Street, Suite 3500, #10054, San Francisco, 94104<br>
    Support@Puls.com<br>
    (860) 596-0177
  </div>
</div>

<!-- CUSTOMER INFO -->
<div class="grid">
  <div><label>Customer Name</label><input></div>
  <div><label>Appointment ID</label><input id="appointmentId"></div>
  <div><label>Email Address</label><input type="email"></div>
  <div><label>Date</label><input type="date"></div>
  <div><label>Phone Number</label><input></div>
  <div><label>Technician</label><input></div>
  <div class="full"><label>Address</label><input></div>
  <div>
    <label>Service Type</label>
    <select>
      <option value="">Select</option>
      <option>Inspection</option>
      <option>Repair</option>
      <option>Estimate</option>
    </select>
  </div>
  <div>
    <label>Appliance Type</label>
    <select>
      <option value="">Select</option>
      <option>Refrigerator</option>
      <option>Washer</option>
      <option>Dryer</option>
      <option>Dishwasher</option>
      <option>Oven / Range</option>
      <option>Microwave</option>
    </select>
  </div>
</div>

<!-- SUMMARY -->
<h3>Appointment Summary</h3>

<label>Inspection Note:</label>
<textarea></textarea>

<label>Recommendation:</label>
<textarea></textarea>

<!-- LABOR -->
<h3>Labor</h3>
<table id="laborTable">
  <tr>
    <th>Description</th>
    <th class="right">Amount</th>
    <th></th>
  </tr>
</table>
<button class="btn" onclick="addRow('laborTable')">+ Add Labor</button>

<!-- PARTS -->
<h3>Parts</h3>
<table id="partsTable">
  <tr>
    <th>Description</th>
    <th class="right">Amount</th>
    <th></th>
  </tr>
</table>
<button class="btn" onclick="addRow('partsTable')">+ Add Parts</button>

<!-- TOTALS -->
<table class="totals">
  <tr>
    <td>S&amp;S Fee</td>
    <td><input type="number" step="0.01" oninput="calculateTotal()"></td>
  </tr>
  <tr>
    <td>Tax</td>
    <td><input type="number" step="0.01" oninput="calculateTotal()"></td>
  </tr>
  <tr>
    <td><strong>Total</strong></td>
    <td><input type="number" step="0.01" id="total" readonly></td>
  </tr>
</table>

<button class="btn" onclick="downloadPDF()">Download PDF</button>

<!-- SCRIPTS -->
<script>
function addRow(tableId) {
  const table = document.getElementById(tableId);
  const row = table.insertRow(-1);
  row.innerHTML = `
    <td><input></td>
    <td><input type="number" step="0.01" oninput="calculateTotal()"></td>
    <td><button class="btn" onclick="removeRow(this)">âœ•</button></td>
  `;
}

function removeRow(btn) {
  btn.closest("tr").remove();
  calculateTotal();
}

function calculateTotal() {
  let sum = 0;
  document.querySelectorAll("input[type='number']").forEach(input => {
    if (input.id !== "total") {
      sum += Number(input.value) || 0;
    }
  });
  document.getElementById("total").value = sum.toFixed(2);
}

function downloadPDF() {
  calculateTotal();

  const clone = document.body.cloneNode(true);

  clone.querySelectorAll("button").forEach(b => b.remove());

  clone.querySelectorAll("input, textarea, select").forEach(el => {
    let value = el.tagName === "SELECT"
      ? el.options[el.selectedIndex]?.text || ""
      : el.value || "";

    const span = document.createElement("span");
    span.textContent = value;
    span.style.display = "block";
    span.style.minHeight = "18px";

    el.replaceWith(span);
  });

  const win = window.open("", "_blank", "width=900,height=650");
  win.document.write(`
    <!DOCTYPE html>
    <html>
    <head>
      <title>Appointment Summary</title>
      <style>${document.querySelector("style").innerHTML}</style>
    </head>
    <body>
      ${clone.innerHTML}
      <script>
        window.onload = function() {
          window.print();
          window.onafterprint = function(){ window.close(); };
        };
      <\/script>
    </body>
    </html>
  `);

  win.document.close();
}
</script>

</body>
</html>
